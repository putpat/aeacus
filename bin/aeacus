#!/usr/bin/env ruby
require 'optparse'

$LOAD_PATH << File.join(File.dirname(__FILE__), '..', 'lib')
require 'aeacus'

pid = nil
OptionParser.new do |opts|
  opts.on("-p", "--pid [PID]", Integer, "The processes PID)") {|i| pid=i }
end.parse!
raise OptionParser::MissingArgument if pid.nil?

$stdout.sync = true
puts "--> Started aeacus"

bt = Aeacus::Backtrace.new(pid)
puts bt.take_traces.join("\n\n\n")
